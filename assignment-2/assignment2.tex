\documentclass[10pt, oneside, letterpaper]{article}
\usepackage[margin=1in]{geometry}
\usepackage[english]{babel}
\usepackage[utf8]{inputenc}
\usepackage{xcolor}
\definecolor{mygreen}{rgb}{0,0.6,0}
\definecolor{mygray}{rgb}{0.5,0.5,0.5}
\definecolor{mymauve}{rgb}{0.58,0,0.82}
\usepackage{listings}
\lstset{
  backgroundcolor=\color{white}, % choose the background color
  basicstyle=\footnotesize\ttfamily, % size of fonts used for the code
  breaklines=true, % automatic line breaking only at whitespace
  frame=single, % add a frame
  captionpos=b, % sets the caption-position to bottom
  commentstyle=\color{mygreen}, % comment style
  escapeinside={\%*}{*)}, % if you want to add LaTeX within your code
  keywordstyle=\color{blue}, % keyword style
  stringstyle=\color{mymauve}, % string literal style
}
\usepackage{enumitem}
\usepackage{blindtext}
\usepackage{datetime2}
\usepackage{fancyhdr}
\usepackage{amsmath}
  \newcommand{\angstrom}{\textup{\AA}} % for units of angstrom
\usepackage{arydshln} % dash line package for matrices
\usepackage{mathtools} % for things like \Aboxed
\usepackage{float}
\usepackage{pgf}
\usepackage{enumitem} % to easily change style of counters in item lists
\usepackage{xurl} % to easily insert URLs in the LaTeX source
\usepackage{braket} % for bra-ket notation
\usepackage{bm} % for bold vector variables
\usepackage{cases} % for piecewise definitions
\usepackage[makeroom]{cancel} % for crossing out terms
\usepackage{graphicx} % for \scalebox
  \newcommand\scalemath[2]{\scalebox{#1}{\mbox{\ensuremath{\displaystyle #2}}}}

\setcounter{MaxMatrixCols}{32} % increase the maximum number of matrix columns

\title{Assignment 2}
\author{Electronic Structures of the Helium atom and Hydrogen Molecule}
\date{Due: 2022/02/11}

\pagestyle{fancy}
\setlength{\headheight}{23pt}
\setlength{\parskip}{1em}
\fancyhf{}
\chead{Assignment 2}
\rhead{Michel Kakulphimp \\ Student \#63542880}
\lhead{ELEC542 \\ UBC MEng}
\cfoot{\thepage}

\begin{document}
\maketitle
\thispagestyle{fancy}

\section{Directions}

The goal in this assignment is to calculate the electronic structure of the helium atom and the hydrogen molecule (two separate systems). The distance between the two hydrogen atoms (the bond length) is 0.74 \angstrom. In this assignment, do not perform geometry optimization, and instead use that fixed bond length in order to calculate the molecular orbitals (both energies and wave functions). Also, note that the problem is in full 3-dimensional space. The goal is to solve the Hartree-Fock equation for these two systems.

Note that you are solving an iterative problem. The Fock operator depends on the orbitals, which you do not have. So, start by making a guess for the orbital shapes, form the Fock operator, solve for the orbitals, and keep iterating until convergence. Use the convergence of the total energy of the system as your convergence criterion.

In this assignment, the calculations must be done directly on a real-space grid, over which the orbitals (wave functions) are defined. So, do not use the Roothaan equations (which we will see soon).

\begin{enumerate}[label=(\alph*)]
  \item (7 points) Directly discretize the Fock operator to put it into matrix form. Describe your approach and show the steps of your derivation all the way to obtaining the matrix equation.
  \item (5 points) Write a computer code to implement what you built in part (a).
  \item (4 points) Plot several molecular orbitals and give their associated energies for the helium atom. Also calculate the total energy of the system (not including the nucleus-nucleus interaction). Discuss your results.
  \item (4 points) Plot several molecular orbitals and give their associated energies for the hydrogen molecule. Also calculate the total energy of the system (not including the nucleus-nucleus interaction). Discuss your results.
\end{enumerate}

\section{Solution}

Since both subjects for this assignment have an even number of electrons that close shells, we can use the restricted Hartree-Fock equation for closed shell systems to numerically calculate the resulting orbitals. The equation is as follows:

\begin{align*}
  \hat{F}(\vec{r})\psi_n(\vec{r}) &= \epsilon_n\psi_n(\vec{r})
\end{align*}

Where $\hat{F}(\vec{r})$ is the Fock operator which is defined as follows:

\begin{align*}
  \hat{F}(\vec{r}) &= \hat{H}_{core}(\vec{r}) + \sum_{n=1}^{N/2}\left[2J_n(\vec{r}) - K_n(\vec{r})\right]\\
\end{align*}

The Fock operator is composed of the core Hamiltonian operator $\hat{H}(\vec{r})$, the Coulomb operator $\hat{J}(\vec{r})$, and the exchange operator $\hat{K}(\vec{r})$. $P_2$ is a transposition operator which switches the indices of the electron indices, something required by the exchange operator.

\begin{align*}
  \hat{H}_{core}(\vec{r}) &= -\frac{1}{2}\nabla_1^2 - \sum_A\frac{Z_A}{\|\vec{r}_{1 A}\|}\\
  \hat{J}_j(\vec{r}_1)\psi_i(\vec{r}_1) &= \psi_i(\vec{r}_1)\int_{-\infty}^{\infty}\left|\psi_i(\vec{r}_2)\right|^2\frac{1}{\|\vec{r}_{12}\|}d\vec{r}_2 \\
  \hat{K}_j(\vec{r}_1)\psi_i(\vec{r}_1) &= \psi_j(\vec{r}_1)\int_{-\infty}^{\infty}\frac{\psi_j^\ast(\vec{r}_2)\psi_i(\vec{r}_2)}{\|\vec{r}_{12}\|}d\vec{r}_2 \\
\end{align*}
Expanded, the Fock operator takes the following form:

\begin{align*}
  \hat{F}(\vec{r}) &= -\frac{1}{2}\nabla_1^2 - \sum_A\frac{Z_A}{\|\vec{r}_{1 A}\|} + \sum_{n=1}^{N/2}\left[2\int_{-\infty}^{\infty}\left|\psi_n(\vec{r}_2)\right|^2\frac{1}{\|\vec{r}_{12}\|}d\vec{r}_2 - \int_{-\infty}^{\infty}\frac{\psi_n^\ast(\vec{r}_2)P_2\psi_n(\vec{r}_2)}{\|\vec{r}_{12}\|}d\vec{r}_2\right]
\end{align*}

For the Helium atom, the Fock operator takes the following form:

\begin{align*}
  \hat{F}(\vec{r}) &= -\frac{1}{2}\nabla_1^2 - \frac{2}{\|\vec{r}_{1 A}\|} + \int_{-\infty}^{\infty}\left|\psi_1(\vec{r}_2)\right|^2\frac{1}{\|\vec{r}_{12}\|}d\vec{r}_2
\end{align*}

and for the Hydrogen molecule, the Fock operator takes the following form:

\begin{align*}
  \hat{F}(\vec{r}) &= -\frac{1}{2}\nabla_1^2 - \frac{1}{\|\vec{r}_{1 A}\|} - \frac{1}{\|\vec{r}_{1 B}\|} + \int_{-\infty}^{\infty}\left|\psi_1(\vec{r}_2)\right|^2\frac{1}{\|\vec{r}_{12}\|}d\vec{r}_2
\end{align*}

For the ground state, we only consider one orbital to fill, which simplifies the exchange operator's index-switch operator in both Fock operators. This also has the effect of making the Coulomb and exchange integrals identical, greatly simplifying the equation. Note that: $\psi_n^\ast(\vec{r}_2)\psi_n(\vec{r}_2) = \left|\psi_1(\vec{r}_2)\right|^2$. For the Helium atom, our value for $Z_A$ is 2 as there are two protons in the nucleus and for the Hydrogen molecule, we consider both Hydrogen nuclei containing one proton each, so $Z_A = Z_B = 1$. The nuclei are separated by 0.74 \angstrom. Since we are solving this problem using Hartree atomic units, we must convert this value accordingly when considering the coordinates of the hydrogen nuclei. In Hartree atomic units, the atomic unit of length converts the Bohr radius $a_0$ to $1$. Therefore, the distance between the two Hydrogen nuclei is $\frac{0.74 \times 0.1\times10^{-9}}{5.29177210903\times10^{-11}} = 1.39839733222307$ atomic units of length.

In order to discretize these equations, the second order differentiation and the finite integration must be numerically performed, in the three spatial dimensions $x$, $y$, and $z$. For the second order differentiation, it will discretize in the following manner:

\begin{align*}
  \nabla^2f(x, y, z) \approx \frac{f(x + \Delta x,y,z) - 2f(x, y, z) + f(x - \Delta x,y,z)}{\Delta x^2}\\
  + \frac{f(x,y + \Delta y,z) - 2f(x, y, z) + f(x,y - \Delta y,z)}{\Delta y^2}\\
  + \frac{f(x,y,z + \Delta z) - 2f(x, y, z) + f(x,y,z - \Delta z)}{\Delta z^2}
\end{align*}

If we choose the same discretization size, such that $\Delta x = \Delta y = \Delta z = h$, the discretization takes the following simplification:

\begin{align*}
  \nabla^2f(x, y, z) \approx \frac{f(x+h,y,z) + f(x,y+h,z) + f(x,y,z+h) - 6f(x, y, z) + f(x-h,y,z) + f(x,y-h,z) + f(x,y,z-h)}{h^2}\\
\end{align*}

As seen in the previous assignment, by forming a column vector of the following form:

\begin{align*}
  \left[f(0,0,0), \hdots ,f(N,0,0),f(0,1,0),\hdots,f(N,1,0),\hdots,f(0,N,0),\hdots,f(N,N,N)\right]^T
\end{align*}

With three dimensions and $N$ discretization points, the total number of equations to solve will be $N^3$. The sparse matrix for the Laplacian differential operator on three variables. Will have 


\section{Discussion}

\begin{itemize}
    \item 
\end{itemize}

\newpage
\section{Code Listings and Data}

\subsection{Python Code Listing}
\label{code-listing-python}
The following is the code written in Python to generate the solutions and plots used in this report.
\lstinputlisting[language=Python]{fock-discretization.py}

\newpage
\section{References}

These aren't citing anything, but they were useful in helping me figure out this assignment.

\begin{itemize}
  \item https://physics.stackexchange.com/questions/20703/why-does-iteratively-solving-the-hartree-fock-equations-result-in-convergence
  \item https://scicomp.stackexchange.com/questions/1297/why-does-iteratively-solving-the-hartree-fock-equations-result-in-convergence
  \item https://nznano.blogspot.com/2018/03/simple-quantum-chemistry-hartree-fock.html % basis
  \item https://github.com/peter-juritz/computational-chemistry
  \item https://github.com/CrawfordGroup/ProgrammingProjects
  \item https://github.com/aromanro/HartreeFock
  \item https://github.com/ipudu/SCFpy % solves using a basis set, can't use
  \item https://medium.com/analytics-vidhya/practical-introduction-to-hartree-fock-448fc64c107b % solves using a basis set, can't use
  \item https://adambaskerville.github.io/posts/HartreeFockGuide/ % relies on Roothaan basis functions, can't use
  \item https://www.12000.org/my_notes/mma_matlab_control/KERNEL/KEse83.htm % Laplacian differential operator for 3D grid
\end{itemize}

\end{document}

